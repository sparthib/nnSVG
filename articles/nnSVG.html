<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="nnSVG">
<title>nnSVG tutorial • nnSVG</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.4/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.4/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.4/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="nnSVG tutorial">
<meta property="og:description" content="nnSVG">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">nnSVG</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.13</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/nnSVG.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/lmweber/nnSVG/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>nnSVG tutorial</h1>
                        <h4 data-toc-skip class="author">Lukas M.
Weber</h4>
            <address class="author_afil">
      Johns Hopkins Bloomberg School of Public Health, Baltimore, MD,
USA<br><h4 data-toc-skip class="author">Stephanie
C. Hicks</h4>
                        
      
      <small class="dont-index">Source: <a href="https://github.com/lmweber/nnSVG/blob/HEAD/vignettes/nnSVG.Rmd" class="external-link"><code>vignettes/nnSVG.Rmd</code></a></small>
      <div class="d-none name"><code>nnSVG.Rmd</code></div>
    </address>
</div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><code>nnSVG</code> is a method for scalable identification of
spatially variable genes (SVGs) in spatially-resolved transcriptomics
data.</p>
<p>The <code>nnSVG</code> method is based on nearest-neighbor Gaussian
processes (<a href="https://www.tandfonline.com/doi/full/10.1080/01621459.2015.1044091" class="external-link">Datta
et al., 2016</a>, <a href="https://www.tandfonline.com/doi/full/10.1080/10618600.2018.1537924" class="external-link">Finley
et al., 2019</a>) and uses the BRISC algorithm (<a href="https://onlinelibrary.wiley.com/doi/full/10.1002/sta4.184" class="external-link">Saha
and Datta, 2018</a>) for model fitting and parameter estimation.
<code>nnSVG</code> allows identification and ranking of SVGs with
flexible length scales across a tissue slide or within spatial domains
defined by covariates. The method scales linearly with the number of
spatial locations and can be applied to datasets containing thousands or
more spatial locations.</p>
<p><code>nnSVG</code> is implemented as an R package within the
Bioconductor framework, and is available from <a href="https://bioconductor.org/packages/nnSVG" class="external-link">Bioconductor</a>.</p>
<p>More details describing the method are available in our preprint,
available from <a href="https://www.biorxiv.org/content/10.1101/2022.05.16.492124v1" class="external-link">bioRxiv</a>.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>The following code will install the latest release version of the
<code>nnSVG</code> package from Bioconductor. Additional details are
shown on the <a href="https://bioconductor.org/packages/nnSVG" class="external-link">Bioconductor</a>
page.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"BiocManager"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"nnSVG"</span><span class="op">)</span></span></code></pre></div>
<p>The latest development version can also be installed from the
<code>devel</code> version of Bioconductor or from <a href="https://github.com/lmweber/nnSVG" class="external-link">GitHub</a>.</p>
</div>
<div class="section level2">
<h2 id="input-data-format">Input data format<a class="anchor" aria-label="anchor" href="#input-data-format"></a>
</h2>
<p>In the examples below, we assume the input data are provided as a <a href="https://bioconductor.org/packages/SpatialExperiment" class="external-link">SpatialExperiment</a>
Bioconductor object. In this case, the outputs are stored in the
<code>rowData</code> of the <code>SpatialExperiment</code> object.</p>
<p>However, the inputs can also be provided as a numeric matrix of
normalized and transformed counts (e.g. log-transformed normalized
counts, also known as logcounts) and a numeric matrix of spatial
coordinates.</p>
<p>To provide the inputs as numeric matrices, please install the
development version of the package from <a href="https://github.com/lmweber/nnSVG" class="external-link">GitHub</a> or the
<code>devel</code> version of Bioconductor (which will become the new
Bioconductor release version in October 2022).</p>
</div>
<div class="section level2">
<h2 id="tutorial">Tutorial<a class="anchor" aria-label="anchor" href="#tutorial"></a>
</h2>
<div class="section level3">
<h3 id="standard-analysis">Standard analysis<a class="anchor" aria-label="anchor" href="#standard-analysis"></a>
</h3>
<div class="section level4">
<h4 id="run-nnsvg">Run nnSVG<a class="anchor" aria-label="anchor" href="#run-nnsvg"></a>
</h4>
<p>Here we show a short example demonstrating how to run
<code>nnSVG</code>.</p>
<p>For faster runtime in this example, we subsample the dataset and run
<code>nnSVG</code> on only a small number of genes. For a full analysis,
the subsampling step can be skipped.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/drighelli/SpatialExperiment" class="external-link">SpatialExperiment</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lmweber/STexampleData" class="external-link">STexampleData</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">scran</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lmweber/nnSVG" class="external-link">nnSVG</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load example dataset from STexampleData package</span></span>
<span><span class="va">spe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/STexampleData/man/STexampleData.html" class="external-link">Visium_humanDLPFC</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">spe</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 33538  4992</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># preprocessing steps</span></span>
<span></span>
<span><span class="co"># keep only spots over tissue</span></span>
<span><span class="va">spe</span> <span class="op">&lt;-</span> <span class="va">spe</span><span class="op">[</span>, <span class="fu">colData</span><span class="op">(</span><span class="va">spe</span><span class="op">)</span><span class="op">$</span><span class="va">in_tissue</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">spe</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 33538  3639</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># skip spot-level quality control, since this has been performed previously </span></span>
<span><span class="co"># on this dataset</span></span>
<span></span>
<span><span class="co"># filter low-expressed and mitochondrial genes</span></span>
<span><span class="co"># using default filtering parameters</span></span>
<span><span class="va">spe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_genes.html">filter_genes</a></span><span class="op">(</span><span class="va">spe</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Gene filtering: removing mitochondrial genes</span></span></code></pre>
<pre><code><span><span class="co">## removed 13 mitochondrial genes</span></span></code></pre>
<pre><code><span><span class="co">## Gene filtering: retaining genes with at least 3 counts in at least 0.5% (n = 19) of spatial locations</span></span></code></pre>
<pre><code><span><span class="co">## removed 30216 out of 33525 genes due to low expression</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate logcounts (log-transformed normalized counts) using scran package</span></span>
<span><span class="co"># using library size factors</span></span>
<span><span class="va">spe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scuttle/man/librarySizeFactors.html" class="external-link">computeLibraryFactors</a></span><span class="op">(</span><span class="va">spe</span><span class="op">)</span></span>
<span><span class="va">spe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scuttle/man/logNormCounts.html" class="external-link">logNormCounts</a></span><span class="op">(</span><span class="va">spe</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">assayNames</span><span class="op">(</span><span class="va">spe</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "counts"    "logcounts"</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># select small set of random genes and several known SVGs for </span></span>
<span><span class="co"># faster runtime in this example</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">ix_random</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">spe</span><span class="op">)</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">known_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MOBP"</span>, <span class="st">"PCP4"</span>, <span class="st">"SNAP25"</span>, <span class="st">"HBB"</span>, <span class="st">"IGKC"</span>, <span class="st">"NPY"</span><span class="op">)</span></span>
<span><span class="va">ix_known</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu">rowData</span><span class="op">(</span><span class="va">spe</span><span class="op">)</span><span class="op">$</span><span class="va">gene_name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">known_genes</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ix_known</span>, <span class="va">ix_random</span><span class="op">)</span></span>
<span></span>
<span><span class="va">spe</span> <span class="op">&lt;-</span> <span class="va">spe</span><span class="op">[</span><span class="va">ix</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">spe</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]   16 3639</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># run nnSVG</span></span>
<span></span>
<span><span class="co"># set seed for reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="co"># using a single thread in this example</span></span>
<span><span class="va">spe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nnSVG.html">nnSVG</a></span><span class="op">(</span><span class="va">spe</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># show results</span></span>
<span><span class="fu">rowData</span><span class="op">(</span><span class="va">spe</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## DataFrame with 16 rows and 17 columns</span></span>
<span><span class="co">##                         gene_id   gene_name    feature_type   sigma.sq</span></span>
<span><span class="co">##                     &lt;character&gt; &lt;character&gt;     &lt;character&gt;  &lt;numeric&gt;</span></span>
<span><span class="co">## ENSG00000211592 ENSG00000211592        IGKC Gene Expression   0.565595</span></span>
<span><span class="co">## ENSG00000168314 ENSG00000168314        MOBP Gene Expression   1.387394</span></span>
<span><span class="co">## ENSG00000122585 ENSG00000122585         NPY Gene Expression   0.285674</span></span>
<span><span class="co">## ENSG00000244734 ENSG00000244734         HBB Gene Expression   0.329421</span></span>
<span><span class="co">## ENSG00000132639 ENSG00000132639      SNAP25 Gene Expression   0.430040</span></span>
<span><span class="co">## ...                         ...         ...             ...        ...</span></span>
<span><span class="co">## ENSG00000130382 ENSG00000130382       MLLT1 Gene Expression 0.00978589</span></span>
<span><span class="co">## ENSG00000036672 ENSG00000036672        USP2 Gene Expression 0.00307278</span></span>
<span><span class="co">## ENSG00000086232 ENSG00000086232     EIF2AK1 Gene Expression 0.00315783</span></span>
<span><span class="co">## ENSG00000106278 ENSG00000106278      PTPRZ1 Gene Expression 0.00279876</span></span>
<span><span class="co">## ENSG00000133606 ENSG00000133606       MKRN1 Gene Expression 0.00632243</span></span>
<span><span class="co">##                    tau.sq        phi    loglik   runtime      mean       var</span></span>
<span><span class="co">##                 &lt;numeric&gt;  &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;</span></span>
<span><span class="co">## ENSG00000211592  0.455044   20.10924  -4531.64     1.723  0.622937  1.007454</span></span>
<span><span class="co">## ENSG00000168314  0.364188    1.10202  -3663.60     1.018  0.805525  1.205673</span></span>
<span><span class="co">## ENSG00000122585  0.280173   71.65328  -3995.23     1.477  0.393975  0.567383</span></span>
<span><span class="co">## ENSG00000244734  0.353754   27.81410  -4044.96     2.228  0.411262  0.697673</span></span>
<span><span class="co">## ENSG00000132639  0.430106    3.03385  -3912.70     0.796  3.451926  0.857922</span></span>
<span><span class="co">## ...                   ...        ...       ...       ...       ...       ...</span></span>
<span><span class="co">## ENSG00000130382  0.283114 50.9885795  -2927.61     1.172  0.298698  0.292976</span></span>
<span><span class="co">## ENSG00000036672  0.241105 12.5383403  -2597.00     0.795  0.248384  0.244218</span></span>
<span><span class="co">## ENSG00000086232  0.266973 25.9300370  -2781.47     0.836  0.275193  0.270208</span></span>
<span><span class="co">## ENSG00000106278  0.367893  9.5295370  -3357.32     0.944  0.352159  0.370784</span></span>
<span><span class="co">## ENSG00000133606  0.272432  0.0827146  -2831.51     1.083  0.295404  0.278806</span></span>
<span><span class="co">##                     spcov    prop_sv loglik_lm   LR_stat      rank        pval</span></span>
<span><span class="co">##                 &lt;numeric&gt;  &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;   &lt;numeric&gt;</span></span>
<span><span class="co">## ENSG00000211592  1.207283   0.554158  -5176.53  1289.775         3           0</span></span>
<span><span class="co">## ENSG00000168314  1.462248   0.792080  -5503.33  3679.464         1           0</span></span>
<span><span class="co">## ENSG00000122585  1.356646   0.504861  -4131.87   273.278         6           0</span></span>
<span><span class="co">## ENSG00000244734  1.395587   0.482191  -4507.99   926.046         4           0</span></span>
<span><span class="co">## ENSG00000132639  0.189973   0.499961  -4884.19  1942.986         2           0</span></span>
<span><span class="co">## ...                   ...        ...       ...       ...       ...         ...</span></span>
<span><span class="co">## ENSG00000130382  0.331183 0.03341030  -2929.28   3.35215        12 0.187106591</span></span>
<span><span class="co">## ENSG00000036672  0.223173 0.01258418  -2598.08   2.15483        13 0.340474000</span></span>
<span><span class="co">## ENSG00000086232  0.204201 0.01169003  -2782.09   1.23716        14 0.538708435</span></span>
<span><span class="co">## ENSG00000106278  0.150226 0.00755009  -3357.83   1.01109        15 0.603178095</span></span>
<span><span class="co">## ENSG00000133606  0.269170 0.02268102  -2839.08  15.15227         9 0.000512539</span></span>
<span><span class="co">##                        padj</span></span>
<span><span class="co">##                   &lt;numeric&gt;</span></span>
<span><span class="co">## ENSG00000211592           0</span></span>
<span><span class="co">## ENSG00000168314           0</span></span>
<span><span class="co">## ENSG00000122585           0</span></span>
<span><span class="co">## ENSG00000244734           0</span></span>
<span><span class="co">## ENSG00000132639           0</span></span>
<span><span class="co">## ...                     ...</span></span>
<span><span class="co">## ENSG00000130382 0.249475454</span></span>
<span><span class="co">## ENSG00000036672 0.419044923</span></span>
<span><span class="co">## ENSG00000086232 0.615666783</span></span>
<span><span class="co">## ENSG00000106278 0.643389968</span></span>
<span><span class="co">## ENSG00000133606 0.000911181</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="investigate-results">Investigate results<a class="anchor" aria-label="anchor" href="#investigate-results"></a>
</h4>
<p>The results are stored in the <code>rowData</code> of the
<code>SpatialExperiment</code> object.</p>
<p>The main results of interest are:</p>
<ul>
<li>
<code>LR_stat</code>: likelihood ratio (LR) statistics</li>
<li>
<code>rank</code>: rank of top SVGs according to LR statistics</li>
<li>
<code>pval</code>: p-values from asymptotic chi-squared distribution
with 2 degrees of freedom</li>
<li>
<code>padj</code>: p-values adjusted for multiple testing, which can
be used to define a cutoff for statistically significant SVGs
(e.g. <code>padj</code> &lt;= 0.05)</li>
<li>
<code>prop_sv</code>: effect size, defined as proportion of spatial
variance out of total variance</li>
</ul>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># number of significant SVGs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu">rowData</span><span class="op">(</span><span class="va">spe</span><span class="op">)</span><span class="op">$</span><span class="va">padj</span> <span class="op">&lt;=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## FALSE  TRUE </span></span>
<span><span class="co">##     7     9</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># show results for top n SVGs</span></span>
<span><span class="fu">rowData</span><span class="op">(</span><span class="va">spe</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="fu">rowData</span><span class="op">(</span><span class="va">spe</span><span class="op">)</span><span class="op">$</span><span class="va">rank</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## DataFrame with 10 rows and 17 columns</span></span>
<span><span class="co">##                         gene_id   gene_name    feature_type   sigma.sq</span></span>
<span><span class="co">##                     &lt;character&gt; &lt;character&gt;     &lt;character&gt;  &lt;numeric&gt;</span></span>
<span><span class="co">## ENSG00000168314 ENSG00000168314        MOBP Gene Expression 1.38739391</span></span>
<span><span class="co">## ENSG00000132639 ENSG00000132639      SNAP25 Gene Expression 0.43003959</span></span>
<span><span class="co">## ENSG00000211592 ENSG00000211592        IGKC Gene Expression 0.56559530</span></span>
<span><span class="co">## ENSG00000244734 ENSG00000244734         HBB Gene Expression 0.32942113</span></span>
<span><span class="co">## ENSG00000183036 ENSG00000183036        PCP4 Gene Expression 0.23102227</span></span>
<span><span class="co">## ENSG00000122585 ENSG00000122585         NPY Gene Expression 0.28567353</span></span>
<span><span class="co">## ENSG00000129562 ENSG00000129562        DAD1 Gene Expression 0.02389607</span></span>
<span><span class="co">## ENSG00000114923 ENSG00000114923      SLC4A3 Gene Expression 0.01147169</span></span>
<span><span class="co">## ENSG00000133606 ENSG00000133606       MKRN1 Gene Expression 0.00632243</span></span>
<span><span class="co">## ENSG00000143543 ENSG00000143543         JTB Gene Expression 0.07545918</span></span>
<span><span class="co">##                    tau.sq         phi    loglik   runtime      mean       var</span></span>
<span><span class="co">##                 &lt;numeric&gt;   &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;</span></span>
<span><span class="co">## ENSG00000168314  0.364188   1.1020178  -3663.60     1.018  0.805525  1.205673</span></span>
<span><span class="co">## ENSG00000132639  0.430106   3.0338473  -3912.70     0.796  3.451926  0.857922</span></span>
<span><span class="co">## ENSG00000211592  0.455044  20.1092411  -4531.64     1.723  0.622937  1.007454</span></span>
<span><span class="co">## ENSG00000244734  0.353754  27.8140982  -4044.96     2.228  0.411262  0.697673</span></span>
<span><span class="co">## ENSG00000183036  0.452735   8.2722846  -4026.22     0.725  0.687961  0.684598</span></span>
<span><span class="co">## ENSG00000122585  0.280173  71.6532828  -3995.23     1.477  0.393975  0.567383</span></span>
<span><span class="co">## ENSG00000129562  0.464723  10.1418839  -3842.24     1.014  0.549318  0.489167</span></span>
<span><span class="co">## ENSG00000114923  0.237260  12.7656276  -2617.36     1.239  0.250768  0.248816</span></span>
<span><span class="co">## ENSG00000133606  0.272432   0.0827146  -2831.51     1.083  0.295404  0.278806</span></span>
<span><span class="co">## ENSG00000143543  0.463580 119.7371493  -4036.28     1.340  0.654919  0.539172</span></span>
<span><span class="co">##                     spcov   prop_sv loglik_lm    LR_stat      rank        pval</span></span>
<span><span class="co">##                 &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;  &lt;numeric&gt; &lt;numeric&gt;   &lt;numeric&gt;</span></span>
<span><span class="co">## ENSG00000168314  1.462248 0.7920804  -5503.33 3679.46397         1 0.00000e+00</span></span>
<span><span class="co">## ENSG00000132639  0.189973 0.4999614  -4884.19 1942.98556         2 0.00000e+00</span></span>
<span><span class="co">## ENSG00000211592  1.207283 0.5541581  -5176.53 1289.77508         3 0.00000e+00</span></span>
<span><span class="co">## ENSG00000244734  1.395587 0.4821910  -4507.99  926.04573         4 0.00000e+00</span></span>
<span><span class="co">## ENSG00000183036  0.698656 0.3378717  -4473.57  894.68884         5 0.00000e+00</span></span>
<span><span class="co">## ENSG00000122585  1.356646 0.5048608  -4131.87  273.27818         6 0.00000e+00</span></span>
<span><span class="co">## ENSG00000129562  0.281410 0.0489053  -3861.98   39.49098         7 2.65854e-09</span></span>
<span><span class="co">## ENSG00000114923  0.427112 0.0461207  -2632.02   29.31376         8 4.31119e-07</span></span>
<span><span class="co">## ENSG00000133606  0.269170 0.0226810  -2839.08   15.15227         9 5.12539e-04</span></span>
<span><span class="co">## ENSG00000143543  0.419439 0.1399883  -4039.07    5.59667        10 6.09115e-02</span></span>
<span><span class="co">##                        padj</span></span>
<span><span class="co">##                   &lt;numeric&gt;</span></span>
<span><span class="co">## ENSG00000168314 0.00000e+00</span></span>
<span><span class="co">## ENSG00000132639 0.00000e+00</span></span>
<span><span class="co">## ENSG00000211592 0.00000e+00</span></span>
<span><span class="co">## ENSG00000244734 0.00000e+00</span></span>
<span><span class="co">## ENSG00000183036 0.00000e+00</span></span>
<span><span class="co">## ENSG00000122585 0.00000e+00</span></span>
<span><span class="co">## ENSG00000129562 6.07667e-09</span></span>
<span><span class="co">## ENSG00000114923 8.62238e-07</span></span>
<span><span class="co">## ENSG00000133606 9.11181e-04</span></span>
<span><span class="co">## ENSG00000143543 9.74584e-02</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot spatial expression of top-ranked SVG</span></span>
<span><span class="va">ix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu">rowData</span><span class="op">(</span><span class="va">spe</span><span class="op">)</span><span class="op">$</span><span class="va">rank</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">ix_name</span> <span class="op">&lt;-</span> <span class="fu">rowData</span><span class="op">(</span><span class="va">spe</span><span class="op">)</span><span class="op">$</span><span class="va">gene_name</span><span class="op">[</span><span class="va">ix</span><span class="op">]</span></span>
<span><span class="va">ix_name</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "MOBP"</span></span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SpatialExperiment/man/SpatialExperiment-methods.html" class="external-link">spatialCoords</a></span><span class="op">(</span><span class="va">spe</span><span class="op">)</span>, </span>
<span>        expr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts</a></span><span class="op">(</span><span class="va">spe</span><span class="op">)</span><span class="op">[</span><span class="va">ix</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pxl_col_in_fullres</span>, y <span class="op">=</span> <span class="va">pxl_row_in_fullres</span>, color <span class="op">=</span> <span class="va">expr</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_color_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"gray90"</span>, high <span class="op">=</span> <span class="st">"blue"</span>, </span>
<span>                       trans <span class="op">=</span> <span class="st">"sqrt"</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">expr</span><span class="op">)</span>, </span>
<span>                       name <span class="op">=</span> <span class="st">"counts"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="va">ix_name</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"italic"</span><span class="op">)</span>, </span>
<span>        panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>        axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>        axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>        axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="nnSVG_files/figure-html/unnamed-chunk-9-1.png" width="480"></p>
</div>
</div>
<div class="section level3">
<h3 id="with-covariates">With covariates<a class="anchor" aria-label="anchor" href="#with-covariates"></a>
</h3>
<div class="section level4">
<h4 id="run-nnsvg-1">Run nnSVG<a class="anchor" aria-label="anchor" href="#run-nnsvg-1"></a>
</h4>
<p><code>nnSVG</code> can also be run on datasets with known covariates,
such as spatial domains or cell types. In this case, the method will
identify SVGs within regions defined by the selected covariates,
e.g. within spatial domains.</p>
<p>Here we run a short example demonstrating this functionality.</p>
<p>As above, for faster runtime in this example, we subsample a very
small subset of the data. For a full analysis, the subsampling step can
be skipped.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/drighelli/SpatialExperiment" class="external-link">SpatialExperiment</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lmweber/STexampleData" class="external-link">STexampleData</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">scran</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lmweber/nnSVG" class="external-link">nnSVG</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load example dataset from STexampleData package</span></span>
<span><span class="va">spe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/STexampleData/man/STexampleData.html" class="external-link">SlideSeqV2_mouseHPC</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">spe</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 23264 53208</span></span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># preprocessing steps</span></span>
<span></span>
<span><span class="co"># remove spots with NA cell type labels</span></span>
<span><span class="va">spe</span> <span class="op">&lt;-</span> <span class="va">spe</span><span class="op">[</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="fu">colData</span><span class="op">(</span><span class="va">spe</span><span class="op">)</span><span class="op">$</span><span class="va">celltype</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">spe</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 23264 15003</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># check cell type labels</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu">colData</span><span class="op">(</span><span class="va">spe</span><span class="op">)</span><span class="op">$</span><span class="va">celltype</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##             Astrocyte                   CA1                   CA3 </span></span>
<span><span class="co">##                  6688                  1320                  1729 </span></span>
<span><span class="co">##         Cajal_Retzius               Choroid                Denate </span></span>
<span><span class="co">##                    60                    21                  1713 </span></span>
<span><span class="co">##     Endothelial_Stalk       Endothelial_Tip           Entorihinal </span></span>
<span><span class="co">##                    96                   118                   111 </span></span>
<span><span class="co">##             Ependymal           Interneuron Microglia_Macrophages </span></span>
<span><span class="co">##                    94                   730                   299 </span></span>
<span><span class="co">##                 Mural          Neurogenesis        Neuron.Slc17a6 </span></span>
<span><span class="co">##                    26                    47                    44 </span></span>
<span><span class="co">##       Oligodendrocyte        Polydendrocyte </span></span>
<span><span class="co">##                  1793                   114</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># filter low-expressed and mitochondrial genes</span></span>
<span><span class="co"># using adjusted filtering parameters for this platform</span></span>
<span><span class="va">spe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_genes.html">filter_genes</a></span><span class="op">(</span></span>
<span>  <span class="va">spe</span>, </span>
<span>  filter_genes_ncounts <span class="op">=</span> <span class="fl">1</span>, </span>
<span>  filter_genes_pcspots <span class="op">=</span> <span class="fl">1</span>, </span>
<span>  filter_mito <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Gene filtering: removing mitochondrial genes</span></span></code></pre>
<pre><code><span><span class="co">## removed 25 mitochondrial genes</span></span></code></pre>
<pre><code><span><span class="co">## Gene filtering: retaining genes with at least 1 counts in at least 1% (n = 151) of spatial locations</span></span></code></pre>
<pre><code><span><span class="co">## removed 14356 out of 23239 genes due to low expression</span></span></code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">spe</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]  8883 15003</span></span></code></pre>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate log-transformed normalized counts using scran package</span></span>
<span><span class="co"># using library size normalization</span></span>
<span><span class="va">spe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scuttle/man/librarySizeFactors.html" class="external-link">computeLibraryFactors</a></span><span class="op">(</span><span class="va">spe</span><span class="op">)</span></span>
<span><span class="va">spe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scuttle/man/logNormCounts.html" class="external-link">logNormCounts</a></span><span class="op">(</span><span class="va">spe</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">assayNames</span><span class="op">(</span><span class="va">spe</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "counts"    "logcounts"</span></span></code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># select small set of random genes and several known SVGs for </span></span>
<span><span class="co"># faster runtime in this example</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">ix_random</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">spe</span><span class="op">)</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">known_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Cpne9"</span>, <span class="st">"Rgs14"</span><span class="op">)</span></span>
<span><span class="va">ix_known</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu">rowData</span><span class="op">(</span><span class="va">spe</span><span class="op">)</span><span class="op">$</span><span class="va">gene_name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">known_genes</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ix_known</span>, <span class="va">ix_random</span><span class="op">)</span></span>
<span></span>
<span><span class="va">spe</span> <span class="op">&lt;-</span> <span class="va">spe</span><span class="op">[</span><span class="va">ix</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">spe</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1]    12 15003</span></span></code></pre>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># run nnSVG with covariates</span></span>
<span></span>
<span><span class="co"># create model matrix for cell type labels</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span> <span class="fu">colData</span><span class="op">(</span><span class="va">spe</span><span class="op">)</span><span class="op">$</span><span class="va">celltype</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 15003    17</span></span></code></pre>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">spe</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># set seed for reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="co"># using a single thread in this example</span></span>
<span><span class="va">spe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nnSVG.html">nnSVG</a></span><span class="op">(</span><span class="va">spe</span>, X <span class="op">=</span> <span class="va">X</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># show results</span></span>
<span><span class="fu">rowData</span><span class="op">(</span><span class="va">spe</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## DataFrame with 12 rows and 15 columns</span></span>
<span><span class="co">##          gene_name    sigma.sq    tau.sq         phi    loglik   runtime</span></span>
<span><span class="co">##        &lt;character&gt;   &lt;numeric&gt; &lt;numeric&gt;   &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;</span></span>
<span><span class="co">## Cpne9        Cpne9 6.91466e-04 0.0275984 1.28473e+01   5484.78    11.890</span></span>
<span><span class="co">## Rgs14        Rgs14 2.77108e-03 0.0452678 1.05096e-04   1650.39    11.619</span></span>
<span><span class="co">## Eogt          Eogt 8.52221e-05 0.0198481 7.81774e+01   8083.08     6.925</span></span>
<span><span class="co">## Ergic1      Ergic1 2.54392e-04 0.0465677 9.77178e+01   1677.16     6.414</span></span>
<span><span class="co">## Zfp330      Zfp330 1.21718e-04 0.0266163 1.54155e+02   5879.76     6.448</span></span>
<span><span class="co">## ...            ...         ...       ...         ...       ...       ...</span></span>
<span><span class="co">## Hdac11      Hdac11 3.54427e-03 0.1648233    145.3031  -7920.47     9.025</span></span>
<span><span class="co">## Nab2          Nab2 3.99610e-05 0.0145549     67.5457  10421.32     6.913</span></span>
<span><span class="co">## Senp3        Senp3 7.97630e-05 0.0253771     36.8091   6248.29     7.457</span></span>
<span><span class="co">## Fbxo6        Fbxo6 9.53681e-05 0.0253767    168.3954   6243.54     7.001</span></span>
<span><span class="co">## Ntng1        Ntng1 2.39135e-03 0.0433036     24.1537   1951.83     8.471</span></span>
<span><span class="co">##             mean       var     spcov    prop_sv loglik_lm    LR_stat      rank</span></span>
<span><span class="co">##        &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;  &lt;numeric&gt; &lt;numeric&gt;  &lt;numeric&gt; &lt;numeric&gt;</span></span>
<span><span class="co">## Cpne9  0.0194924 0.0283971  1.349024 0.02444221   5455.66   58.23907         3</span></span>
<span><span class="co">## Rgs14  0.0360053 0.0485672  1.462036 0.05768411   1515.16  270.46142         1</span></span>
<span><span class="co">## Eogt   0.0125243 0.0200072  0.737094 0.00427535   8082.32    1.52761         6</span></span>
<span><span class="co">## Ergic1 0.0359343 0.0471421  0.443857 0.00543316   1676.61    1.10862         8</span></span>
<span><span class="co">## Zfp330 0.0201203 0.0267799  0.548332 0.00455227   5879.05    1.42306         7</span></span>
<span><span class="co">## ...          ...       ...       ...        ...       ...        ...       ...</span></span>
<span><span class="co">## Hdac11 0.1258726 0.1705333  0.472969 0.02105081  -7923.51   6.072536         4</span></span>
<span><span class="co">## Nab2   0.0120832 0.0146742  0.523161 0.00273802  10421.82  -1.016734        12</span></span>
<span><span class="co">## Senp3  0.0199706 0.0255396  0.447208 0.00313326   6248.60  -0.631543        11</span></span>
<span><span class="co">## Fbxo6  0.0188249 0.0255584  0.518763 0.00374402   6243.59  -0.103396        10</span></span>
<span><span class="co">## Ntng1  0.0341843 0.0466474  1.430523 0.05233292   1854.40 194.856131         2</span></span>
<span><span class="co">##               pval        padj</span></span>
<span><span class="co">##          &lt;numeric&gt;   &lt;numeric&gt;</span></span>
<span><span class="co">## Cpne9  2.25708e-13 9.02833e-13</span></span>
<span><span class="co">## Rgs14  0.00000e+00 0.00000e+00</span></span>
<span><span class="co">## Eogt   4.65891e-01 8.41529e-01</span></span>
<span><span class="co">## Ergic1 5.74469e-01 8.61704e-01</span></span>
<span><span class="co">## Zfp330 4.90892e-01 8.41529e-01</span></span>
<span><span class="co">## ...            ...         ...</span></span>
<span><span class="co">## Hdac11   0.0480137    0.144041</span></span>
<span><span class="co">## Nab2     1.0000000    1.000000</span></span>
<span><span class="co">## Senp3    1.0000000    1.000000</span></span>
<span><span class="co">## Fbxo6    1.0000000    1.000000</span></span>
<span><span class="co">## Ntng1    0.0000000    0.000000</span></span></code></pre>
<p>Note that if there are any empty levels in the factor used to create
the design matrix, these can be removed as follows:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create model matrix after dropping empty factor levels</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu">colData</span><span class="op">(</span><span class="va">spe</span><span class="op">)</span><span class="op">$</span><span class="va">celltype</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="investigate-results-1">Investigate results<a class="anchor" aria-label="anchor" href="#investigate-results-1"></a>
</h4>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># number of significant SVGs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu">rowData</span><span class="op">(</span><span class="va">spe</span><span class="op">)</span><span class="op">$</span><span class="va">padj</span> <span class="op">&lt;=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## FALSE  TRUE </span></span>
<span><span class="co">##     9     3</span></span></code></pre>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># show results for top n SVGs</span></span>
<span><span class="fu">rowData</span><span class="op">(</span><span class="va">spe</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="fu">rowData</span><span class="op">(</span><span class="va">spe</span><span class="op">)</span><span class="op">$</span><span class="va">rank</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## DataFrame with 10 rows and 15 columns</span></span>
<span><span class="co">##          gene_name    sigma.sq    tau.sq         phi    loglik   runtime</span></span>
<span><span class="co">##        &lt;character&gt;   &lt;numeric&gt; &lt;numeric&gt;   &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;</span></span>
<span><span class="co">## Rgs14        Rgs14 2.77108e-03 0.0452678 1.05096e-04   1650.39    11.619</span></span>
<span><span class="co">## Ntng1        Ntng1 2.39135e-03 0.0433036 2.41537e+01   1951.83     8.471</span></span>
<span><span class="co">## Cpne9        Cpne9 6.91466e-04 0.0275984 1.28473e+01   5484.78    11.890</span></span>
<span><span class="co">## Hdac11      Hdac11 3.54427e-03 0.1648233 1.45303e+02  -7920.47     9.025</span></span>
<span><span class="co">## Cul1          Cul1 4.19375e-04 0.0688365 9.03170e+01  -1259.18     7.491</span></span>
<span><span class="co">## Eogt          Eogt 8.52221e-05 0.0198481 7.81774e+01   8083.08     6.925</span></span>
<span><span class="co">## Zfp330      Zfp330 1.21718e-04 0.0266163 1.54155e+02   5879.76     6.448</span></span>
<span><span class="co">## Ergic1      Ergic1 2.54392e-04 0.0465677 9.77178e+01   1677.16     6.414</span></span>
<span><span class="co">## Gclc          Gclc 1.22209e-04 0.0345001 1.19976e+02   3941.26     6.453</span></span>
<span><span class="co">## Fbxo6        Fbxo6 9.53681e-05 0.0253767 1.68395e+02   6243.54     7.001</span></span>
<span><span class="co">##             mean       var     spcov    prop_sv loglik_lm     LR_stat      rank</span></span>
<span><span class="co">##        &lt;numeric&gt; &lt;numeric&gt; &lt;numeric&gt;  &lt;numeric&gt; &lt;numeric&gt;   &lt;numeric&gt; &lt;numeric&gt;</span></span>
<span><span class="co">## Rgs14  0.0360053 0.0485672  1.462036 0.05768411   1515.16 270.4614203         1</span></span>
<span><span class="co">## Ntng1  0.0341843 0.0466474  1.430523 0.05233292   1854.40 194.8561307         2</span></span>
<span><span class="co">## Cpne9  0.0194924 0.0283971  1.349024 0.02444221   5455.66  58.2390704         3</span></span>
<span><span class="co">## Hdac11 0.1258726 0.1705333  0.472969 0.02105081  -7923.51   6.0725361         4</span></span>
<span><span class="co">## Cul1   0.0548957 0.0696223  0.373047 0.00605545  -1260.02   1.6933522         5</span></span>
<span><span class="co">## Eogt   0.0125243 0.0200072  0.737094 0.00427535   8082.32   1.5276072         6</span></span>
<span><span class="co">## Zfp330 0.0201203 0.0267799  0.548332 0.00455227   5879.05   1.4230622         7</span></span>
<span><span class="co">## Ergic1 0.0359343 0.0471421  0.443857 0.00543316   1676.61   1.1086170         8</span></span>
<span><span class="co">## Gclc   0.0256188 0.0347265  0.431513 0.00352979   3941.30  -0.0749109         9</span></span>
<span><span class="co">## Fbxo6  0.0188249 0.0255584  0.518763 0.00374402   6243.59  -0.1033956        10</span></span>
<span><span class="co">##               pval        padj</span></span>
<span><span class="co">##          &lt;numeric&gt;   &lt;numeric&gt;</span></span>
<span><span class="co">## Rgs14  0.00000e+00 0.00000e+00</span></span>
<span><span class="co">## Ntng1  0.00000e+00 0.00000e+00</span></span>
<span><span class="co">## Cpne9  2.25708e-13 9.02833e-13</span></span>
<span><span class="co">## Hdac11 4.80137e-02 1.44041e-01</span></span>
<span><span class="co">## Cul1   4.28838e-01 8.41529e-01</span></span>
<span><span class="co">## Eogt   4.65891e-01 8.41529e-01</span></span>
<span><span class="co">## Zfp330 4.90892e-01 8.41529e-01</span></span>
<span><span class="co">## Ergic1 5.74469e-01 8.61704e-01</span></span>
<span><span class="co">## Gclc   1.00000e+00 1.00000e+00</span></span>
<span><span class="co">## Fbxo6  1.00000e+00 1.00000e+00</span></span></code></pre>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot spatial expression of top-ranked SVG</span></span>
<span><span class="va">ix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu">rowData</span><span class="op">(</span><span class="va">spe</span><span class="op">)</span><span class="op">$</span><span class="va">rank</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">ix_name</span> <span class="op">&lt;-</span> <span class="fu">rowData</span><span class="op">(</span><span class="va">spe</span><span class="op">)</span><span class="op">$</span><span class="va">gene_name</span><span class="op">[</span><span class="va">ix</span><span class="op">]</span></span>
<span><span class="va">ix_name</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Rgs14"</span></span></code></pre>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SpatialExperiment/man/SpatialExperiment-methods.html" class="external-link">spatialCoords</a></span><span class="op">(</span><span class="va">spe</span><span class="op">)</span>, </span>
<span>        expr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">counts</a></span><span class="op">(</span><span class="va">spe</span><span class="op">)</span><span class="op">[</span><span class="va">ix</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">xcoord</span>, y <span class="op">=</span> <span class="va">ycoord</span>, color <span class="op">=</span> <span class="va">expr</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_color_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"gray90"</span>, high <span class="op">=</span> <span class="st">"blue"</span>, </span>
<span>                       trans <span class="op">=</span> <span class="st">"sqrt"</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">expr</span><span class="op">)</span>, </span>
<span>                       name <span class="op">=</span> <span class="st">"counts"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="va">ix_name</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"italic"</span><span class="op">)</span>, </span>
<span>        panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>        axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>        axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>        axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="nnSVG_files/figure-html/unnamed-chunk-18-1.png" width="480"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="session-information">Session information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.2.2 (2022-10-31)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">## Running under: Ubuntu 22.04.1 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3</span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats4    stats     graphics  grDevices utils     datasets  methods  </span></span>
<span><span class="co">## [8] base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">##  [1] ggplot2_3.4.0               nnSVG_1.1.13               </span></span>
<span><span class="co">##  [3] scran_1.24.1                scuttle_1.6.3              </span></span>
<span><span class="co">##  [5] STexampleData_1.4.5         ExperimentHub_2.4.0        </span></span>
<span><span class="co">##  [7] AnnotationHub_3.4.0         BiocFileCache_2.4.0        </span></span>
<span><span class="co">##  [9] dbplyr_2.2.1                SpatialExperiment_1.6.1    </span></span>
<span><span class="co">## [11] SingleCellExperiment_1.18.1 SummarizedExperiment_1.26.1</span></span>
<span><span class="co">## [13] Biobase_2.56.0              GenomicRanges_1.48.0       </span></span>
<span><span class="co">## [15] GenomeInfoDb_1.32.4         IRanges_2.30.1             </span></span>
<span><span class="co">## [17] S4Vectors_0.34.0            BiocGenerics_0.42.0        </span></span>
<span><span class="co">## [19] MatrixGenerics_1.8.1        matrixStats_0.63.0         </span></span>
<span><span class="co">## [21] BiocStyle_2.24.0           </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##   [1] systemfonts_1.0.4             igraph_1.3.5                 </span></span>
<span><span class="co">##   [3] BiocParallel_1.30.4           digest_0.6.30                </span></span>
<span><span class="co">##   [5] htmltools_0.5.4               magick_2.7.3                 </span></span>
<span><span class="co">##   [7] fansi_1.0.3                   magrittr_2.0.3               </span></span>
<span><span class="co">##   [9] memoise_2.0.1                 ScaledMatrix_1.4.1           </span></span>
<span><span class="co">##  [11] cluster_2.1.4                 limma_3.52.4                 </span></span>
<span><span class="co">##  [13] Biostrings_2.64.1             rdist_0.0.5                  </span></span>
<span><span class="co">##  [15] R.utils_2.12.2                pkgdown_2.0.6                </span></span>
<span><span class="co">##  [17] colorspace_2.0-3              blob_1.2.3                   </span></span>
<span><span class="co">##  [19] rappdirs_0.3.3                textshaping_0.3.6            </span></span>
<span><span class="co">##  [21] xfun_0.35                     dplyr_1.0.10                 </span></span>
<span><span class="co">##  [23] crayon_1.5.2                  RCurl_1.98-1.9               </span></span>
<span><span class="co">##  [25] jsonlite_1.8.4                glue_1.6.2                   </span></span>
<span><span class="co">##  [27] gtable_0.3.1                  zlibbioc_1.42.0              </span></span>
<span><span class="co">##  [29] XVector_0.36.0                DelayedArray_0.22.0          </span></span>
<span><span class="co">##  [31] BiocSingular_1.12.0           DropletUtils_1.16.0          </span></span>
<span><span class="co">##  [33] Rhdf5lib_1.18.2               HDF5Array_1.24.2             </span></span>
<span><span class="co">##  [35] scales_1.2.1                  DBI_1.1.3                    </span></span>
<span><span class="co">##  [37] edgeR_3.38.4                  Rcpp_1.0.9                   </span></span>
<span><span class="co">##  [39] xtable_1.8-4                  dqrng_0.3.0                  </span></span>
<span><span class="co">##  [41] bit_4.0.5                     rsvd_1.0.5                   </span></span>
<span><span class="co">##  [43] metapod_1.4.0                 httr_1.4.4                   </span></span>
<span><span class="co">##  [45] ellipsis_0.3.2                farver_2.1.1                 </span></span>
<span><span class="co">##  [47] pkgconfig_2.0.3               R.methodsS3_1.8.2            </span></span>
<span><span class="co">##  [49] sass_0.4.4                    locfit_1.5-9.6               </span></span>
<span><span class="co">##  [51] utf8_1.2.2                    labeling_0.4.2               </span></span>
<span><span class="co">##  [53] tidyselect_1.2.0              rlang_1.0.6                  </span></span>
<span><span class="co">##  [55] later_1.3.0                   AnnotationDbi_1.58.0         </span></span>
<span><span class="co">##  [57] munsell_0.5.0                 BiocVersion_3.15.2           </span></span>
<span><span class="co">##  [59] tools_4.2.2                   cachem_1.0.6                 </span></span>
<span><span class="co">##  [61] cli_3.4.1                     generics_0.1.3               </span></span>
<span><span class="co">##  [63] RSQLite_2.2.19                evaluate_0.18                </span></span>
<span><span class="co">##  [65] stringr_1.5.0                 fastmap_1.1.0                </span></span>
<span><span class="co">##  [67] yaml_2.3.6                    ragg_1.2.4                   </span></span>
<span><span class="co">##  [69] knitr_1.41                    bit64_4.0.5                  </span></span>
<span><span class="co">##  [71] fs_1.5.2                      purrr_0.3.5                  </span></span>
<span><span class="co">##  [73] RANN_2.6.1                    KEGGREST_1.36.3              </span></span>
<span><span class="co">##  [75] pbapply_1.6-0                 sparseMatrixStats_1.8.0      </span></span>
<span><span class="co">##  [77] mime_0.12                     BRISC_1.0.5                  </span></span>
<span><span class="co">##  [79] R.oo_1.25.0                   compiler_4.2.2               </span></span>
<span><span class="co">##  [81] filelock_1.0.2                curl_4.3.3                   </span></span>
<span><span class="co">##  [83] png_0.1-8                     interactiveDisplayBase_1.34.0</span></span>
<span><span class="co">##  [85] tibble_3.1.8                  statmod_1.4.37               </span></span>
<span><span class="co">##  [87] bslib_0.4.1                   stringi_1.7.8                </span></span>
<span><span class="co">##  [89] highr_0.9                     desc_1.4.2                   </span></span>
<span><span class="co">##  [91] lattice_0.20-45               bluster_1.6.0                </span></span>
<span><span class="co">##  [93] Matrix_1.5-1                  vctrs_0.5.1                  </span></span>
<span><span class="co">##  [95] pillar_1.8.1                  lifecycle_1.0.3              </span></span>
<span><span class="co">##  [97] rhdf5filters_1.8.0            BiocManager_1.30.19          </span></span>
<span><span class="co">##  [99] jquerylib_0.1.4               BiocNeighbors_1.14.0         </span></span>
<span><span class="co">## [101] bitops_1.0-7                  irlba_2.3.5.1                </span></span>
<span><span class="co">## [103] httpuv_1.6.6                  R6_2.5.1                     </span></span>
<span><span class="co">## [105] bookdown_0.30                 promises_1.2.0.1             </span></span>
<span><span class="co">## [107] codetools_0.2-18              assertthat_0.2.1             </span></span>
<span><span class="co">## [109] rhdf5_2.40.0                  rprojroot_2.0.3              </span></span>
<span><span class="co">## [111] rjson_0.2.21                  withr_2.5.0                  </span></span>
<span><span class="co">## [113] GenomeInfoDbData_1.2.8        parallel_4.2.2               </span></span>
<span><span class="co">## [115] grid_4.2.2                    beachmat_2.12.0              </span></span>
<span><span class="co">## [117] rmarkdown_2.18                DelayedMatrixStats_1.18.2    </span></span>
<span><span class="co">## [119] shiny_1.7.3</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Lukas M. Weber, Stephanie C. Hicks.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
